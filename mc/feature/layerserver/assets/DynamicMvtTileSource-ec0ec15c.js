var xe=Object.defineProperty;var we=(e,t,i)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var p=(e,t,i)=>(we(e,typeof t!="symbol"?t+"":t,i),i);import{S as ge,U as ve}from"./LocalStorageSource-4f66d5e4.js";import{T as w,i as ye,B as be,G as Z}from"./index-c617b926.js";import{F as X}from"./ShowDataLayer-d3a6de3c.js";import{U as _}from"./Utils-498bb79d.js";import{g as Y,C as A}from"./Constants-45d3b9c3.js";function Fe(e,t){for(var i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}class $ extends X{constructor(t,i,r,n,s){super();const o=new Set;ge.ListStabilized(n.bounds.mapD(f=>{if(s!=null&&s.isActive&&!(s!=null&&s.isActive.data)||n.zoom.data<i)return;const u=Math.floor(t.data),c=w.TileRangeBetween(u,f.getNorth(),f.getEast(),f.getSouth(),f.getWest());if(c.total>500){console.warn("Got a really big tilerange, bounds and location might be out of sync");return}const d=w.MapRange(c,(l,g)=>w.tile_index(u,l,g)).filter(l=>!o.has(l));if(d.length!==0)return d},[s==null?void 0:s.isActive,n.zoom]).stabilized(250)).addCallbackAndRunD(f=>{for(const u of f)o.add(u),super.addSource(r(u))})}}var Ee=h,M=ye;function h(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}h.Varint=0;h.Fixed64=1;h.Bytes=2;h.Fixed32=5;var N=65536*65536,W=1/N,_e=12,Q=typeof TextDecoder>"u"?null:new TextDecoder("utf8");h.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=r&7,e(n,t,this),this.pos===s&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=j(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=K(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=j(this.buf,this.pos)+j(this.buf,this.pos+4)*N;return this.pos+=8,e},readSFixed64:function(){var e=j(this.buf,this.pos)+K(this.buf,this.pos+4)*N;return this.pos+=8,e},readFloat:function(){var e=M.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=M.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i,r;return r=t[this.pos++],i=r&127,r<128||(r=t[this.pos++],i|=(r&127)<<7,r<128)||(r=t[this.pos++],i|=(r&127)<<14,r<128)||(r=t[this.pos++],i|=(r&127)<<21,r<128)?i:(r=t[this.pos],i|=(r&15)<<28,Se(i,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=_e&&Q?$e(this.buf,t,e):Ae(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==h.Bytes)return e.push(this.readVarint(t));var i=m(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==h.Bytes)return e.push(this.readSVarint());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==h.Bytes)return e.push(this.readBoolean());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==h.Bytes)return e.push(this.readFloat());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==h.Bytes)return e.push(this.readDouble());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==h.Bytes)return e.push(this.readFixed32());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==h.Bytes)return e.push(this.readSFixed32());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==h.Bytes)return e.push(this.readFixed64());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==h.Bytes)return e.push(this.readSFixed64());var t=m(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===h.Varint)for(;this.buf[this.pos++]>127;);else if(t===h.Bytes)this.pos=this.readVarint()+this.pos;else if(t===h.Fixed32)this.pos+=4;else if(t===h.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),y(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),y(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),y(this.buf,e&-1,this.pos),y(this.buf,Math.floor(e*W),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),y(this.buf,e&-1,this.pos),y(this.buf,Math.floor(e*W),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){De(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=Ie(this.buf,e,this.pos);var i=this.pos-t;i>=128&&J(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),M.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),M.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;r>=128&&J(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,i){this.writeTag(e,h.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,je,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Be,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Pe,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Te,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Ne,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,ze,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Ce,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ue,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Oe,t)},writeBytesField:function(e,t){this.writeTag(e,h.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,h.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,h.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,h.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,h.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,h.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,h.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,h.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,h.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,h.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};function Se(e,t,i){var r=i.buf,n,s;if(s=r[i.pos++],n=(s&112)>>4,s<128||(s=r[i.pos++],n|=(s&127)<<3,s<128)||(s=r[i.pos++],n|=(s&127)<<10,s<128)||(s=r[i.pos++],n|=(s&127)<<17,s<128)||(s=r[i.pos++],n|=(s&127)<<24,s<128)||(s=r[i.pos++],n|=(s&1)<<31,s<128))return v(e,n,t);throw new Error("Expected varint not more than 10 bytes")}function m(e){return e.type===h.Bytes?e.readVarint()+e.pos:e.pos+1}function v(e,t,i){return i?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function De(e,t){var i,r;if(e>=0?(i=e%4294967296|0,r=e/4294967296|0):(i=~(-e%4294967296),r=~(-e/4294967296),i^4294967295?i=i+1|0:(i=0,r=r+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),Ve(i,r,t),Me(r,t)}function Ve(e,t,i){i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos]=e&127}function Me(e,t){var i=(e&7)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function J(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));i.realloc(r);for(var n=i.pos-1;n>=e;n--)i.buf[n+r]=i.buf[n]}function je(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Be(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Te(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Ne(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Pe(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function ze(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Ce(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Ue(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Oe(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function j(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function y(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function K(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Ae(e,t,i){for(var r="",n=t;n<i;){var s=e[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a>i)break;var f,u,c;a===1?s<128&&(o=s):a===2?(f=e[n+1],(f&192)===128&&(o=(s&31)<<6|f&63,o<=127&&(o=null))):a===3?(f=e[n+1],u=e[n+2],(f&192)===128&&(u&192)===128&&(o=(s&15)<<12|(f&63)<<6|u&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(f=e[n+1],u=e[n+2],c=e[n+3],(f&192)===128&&(u&192)===128&&(c&192)===128&&(o=(s&15)<<18|(f&63)<<12|(u&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),r+=String.fromCharCode(o),n+=a}return r}function $e(e,t,i){return Q.decode(e.subarray(t,i))}function Ie(e,t,i){for(var r=0,n,s;r<t.length;r++){if(n=t.charCodeAt(r),n>55295&&n<57344)if(s)if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,s=n;continue}else n=s-55296<<10|n-56320|65536,s=null;else{n>56319||r+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):s=n;continue}else s&&(e[i++]=239,e[i++]=191,e[i++]=189,s=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=n&63|128)}return i}const Le=Y(Ee),Re="pbf",Ge="3.2.1",We="a low-level, lightweight protocol buffers implementation in JavaScript",Je="index.js",Ke="dist/pbf.js",qe="dist/pbf.js",He={bench:"node bench/bench.js",test:"eslint index.js compile.js test/*.js bench/bench-tiles.js bin/pbf && tap test/*.test.js && npm run build-min",cov:"tap test/*.test.js --cov --coverage-report=html","build-min":"mkdirp dist && browserify index.js -s Pbf | uglifyjs -c -m > dist/pbf.js","build-dev":"mkdirp dist && browserify index.js -d -s Pbf > dist/pbf-dev.js",prepublishOnly:"npm run build-dev && npm run build-min"},Ze=["bin","dist","compile.js"],Xe={pbf:"bin/pbf"},Ye={type:"git",url:"git@github.com:mapbox/pbf.git"},Qe=["protocol","buffer","pbf","protobuf","binary","format","serialization","encoder","decoder"],ke="Konstantin Kaefer",et="BSD-3-Clause",tt={url:"https://github.com/mapbox/pbf/issues"},it="https://github.com/mapbox/pbf",rt={ieee754:"^1.1.12","resolve-protobuf-schema":"^2.1.0"},nt={benchmark:"^2.1.4",browserify:"^16.2.3",eslint:"^5.15.1","eslint-config-mourner":"^2.0.3",mkdirp:"^0.5.1",protobufjs:"^6.8.8","protocol-buffers":"^4.1.0",tap:"^12.6.0","tile-stats-runner":"^1.0.0","uglify-js":"^3.6.1"},st={extends:"mourner",rules:{"space-before-function-paren":[2,"never"],"key-spacing":0,"no-empty":0,"global-require":0,"no-cond-assign":0,indent:[2,4,{flatTernaryExpressions:!0}]}},ot={name:Re,version:Ge,description:We,main:Je,unpkg:Ke,jsdelivr:qe,scripts:He,files:Ze,bin:Xe,repository:Ye,keywords:Qe,author:ke,license:et,bugs:tt,homepage:it,dependencies:rt,devDependencies:nt,eslintConfig:st};var k=ee,at=ot.version;function ee(e){var t=`var exports = {};
`;return t+=te(e)+`
`,t+=`return exports;
`,new Function(t)()}ee.raw=te;function te(e,t){var i="'use strict'; // code generated by pbf v"+at+`
`,r=se(B(e,null),e.syntax);return i+ie(r,t||{})}function ie(e,t){var i="";e._proto.fields&&(i+=ft(e,t)),e._proto.values&&(i+=ut(e,t));for(var r=0;r<e._children.length;r++)i+=ie(e._children[r],t);return i}function ft(e,t){var i=e._name,r=e._proto.fields,n=0,s=`
// `+i+` ========================================

`;if((!t.noRead||!t.noWrite)&&(s+=re(e,t)+` {};

`),!t.noRead){s+=i+`.read = function (pbf, end) {
`,s+="    return pbf.readFields("+i+"._readField, "+ct(e)+`, end);
`,s+=`};
`,s+=i+`._readField = function (tag, obj, pbf) {
`;for(var o=0;o<r.length;o++){var a=r[o],f=ht(e,a),u=L(e,a);s+="    "+(o?"else if":"if")+" (tag === "+a.tag+") "+(a.type==="map"?" { ":"")+(a.type==="map"?lt(f,a.name,n++):a.repeated&&!u?"obj."+a.name+".push("+f+")":a.repeated&&u?f:"obj."+a.name+" = "+f),a.oneof&&(s+=", obj."+a.oneof+" = "+JSON.stringify(a.name)),s+=";"+(a.type==="map"?" }":"")+`
`}s+=`};
`}if(!t.noWrite){for(s+=i+`.write = function (obj, pbf) {
`,n=0,o=0;o<r.length;o++){a=r[o];var c=a.repeated&&!z(a)?pt(e,a,n++):a.type==="map"?dt(e,a,n++):I(e,a,"obj."+a.name);s+=vt(e,a),s+=c+`;
`}s+=`};
`}return s}function ut(e,t){return`
`+re(e,t)+" "+JSON.stringify(e._proto.values,null,4)+`;
`}function re(e,t){var i=t.exports||"exports";return(e._root?"var "+e._name+" = "+i+".":"")+e._name+" ="}function ct(e){for(var t={},i=0;i<e._proto.fields.length;i++){var r=e._proto.fields[i];t[r.name+": "+JSON.stringify(e._defaults[r.name])]=!0,r.oneof&&(t[r.oneof+": null"]=!0)}return"{"+Object.keys(t).join(", ")+"}"}function P(e){return e&&e._proto.values}function S(e,t){if(t.type==="map")return e[ne(t.tag)];var i=t.type.split(".");return i.reduce(function(r,n){return r&&r[n]},e)}function ht(e,t){var i=S(e,t);if(i){if(i._proto.fields)return i._name+".read(pbf, pbf.readVarint() + pbf.pos)";if(!P(i))throw new Error("Unexpected type: "+i._name)}var r=P(i)?"enum":t.type,n="pbf.read",s=r==="int32"||r==="int64"?"true":"",o="("+s+")";switch(L(e,t)&&(n+="Packed",o="(obj."+t.name+(s?", "+s:"")+")"),r){case"string":return n+"String"+o;case"float":return n+"Float"+o;case"double":return n+"Double"+o;case"bool":return n+"Boolean"+o;case"enum":case"uint32":case"uint64":case"int32":case"int64":return n+"Varint"+o;case"sint32":case"sint64":return n+"SVarint"+o;case"fixed32":return n+"Fixed32"+o;case"fixed64":return n+"Fixed64"+o;case"sfixed32":return n+"SFixed32"+o;case"sfixed64":return n+"SFixed64"+o;case"bytes":return n+"Bytes"+o;default:throw new Error("Unexpected type: "+t.type)}}function I(e,t,i){var r="pbf.write";z(t)&&(r+="Packed");var n=(z(t)?"":"Field")+"("+t.tag+", "+i+")",s=S(e,t);if(s){if(s._proto.fields)return r+"Message("+t.tag+", "+s._name+".write, "+i+")";if(s._proto.values)return r+"Varint"+n;throw new Error("Unexpected type: "+s._name)}switch(t.type){case"string":return r+"String"+n;case"float":return r+"Float"+n;case"double":return r+"Double"+n;case"bool":return r+"Boolean"+n;case"enum":case"uint32":case"uint64":case"int32":case"int64":return r+"Varint"+n;case"sint32":case"sint64":return r+"SVarint"+n;case"fixed32":return r+"Fixed32"+n;case"fixed64":return r+"Fixed64"+n;case"sfixed32":return r+"SFixed32"+n;case"sfixed64":return r+"SFixed64"+n;case"bytes":return r+"Bytes"+n;default:throw new Error("Unexpected type: "+t.type)}}function lt(e,t,i){return(i?"":"var ")+"entry = "+e+"; obj."+t+"[entry.key] = entry.value"}function pt(e,t,i){return"for ("+(i?"":"var ")+"i = 0; i < obj."+t.name+".length; i++) "+I(e,t,"obj."+t.name+"[i]")}function dt(e,t,i){var r="obj."+t.name;return"for ("+(i?"":"var ")+"i in "+r+") if (Object.prototype.hasOwnProperty.call("+r+", i)) "+I(e,t,"{ key: i, value: "+r+"[i] }")}function ne(e){return"_FieldEntry"+e}function q(e,t,i){return{name:e,type:t,tag:i,map:null,oneof:null,required:!1,repeated:!1,options:{}}}function mt(e){return{name:ne(e.tag),enums:[],messages:[],extensions:null,fields:[q("key",e.map.from,1),q("value",e.map.to,2)]}}function B(e,t){var i=Object.create(t);i._proto=e,i._children=[],i._defaults={},t&&(t[e.name]=i,t._name?(i._root=!1,i._name=t._name+"."+e.name):(i._root=!0,i._name=e.name));for(var r=0;e.enums&&r<e.enums.length;r++)i._children.push(B(e.enums[r],i));for(r=0;e.messages&&r<e.messages.length;r++)i._children.push(B(e.messages[r],i));for(r=0;e.fields&&r<e.fields.length;r++)e.fields[r].type==="map"&&i._children.push(B(mt(e.fields[r]),i));return i}function xt(e,t){if(e.repeated)return[];switch(e.type){case"float":case"double":return t?parseFloat(t):0;case"uint32":case"uint64":case"int32":case"int64":case"sint32":case"sint64":case"fixed32":case"fixed64":case"sfixed32":case"sfixed64":return t?parseInt(t,10):0;case"string":return t||"";case"bool":return t==="true";case"map":return{};default:return null}}function L(e,t){var i=P(S(e,t))?"enum":t.type;switch(t.repeated&&i){case"float":case"double":case"uint32":case"uint64":case"int32":case"int64":case"sint32":case"sint64":case"fixed32":case"fixed64":case"sfixed32":case"enum":case"bool":return!0}return!1}function wt(e,t,i){i<3||t.options.packed===void 0&&L(e,t)&&(t.options.packed="true")}function gt(e,t,i){var r=t.options,n=S(e,t),s=n&&n._proto.values,o=i<3?r.default:void 0;s&&!t.repeated?e._defaults[t.name]=s[o]||0:e._defaults[t.name]=xt(t,o)}function se(e,t){for(var i=e._proto,r=0;r<e._children.length;r++)se(e._children[r],t);if(i.fields)for(r=0;r<i.fields.length;r++)wt(e,i.fields[r],t),gt(e,i.fields[r],t);return e}function vt(e,t){var i=e._defaults[t.name],r=S(e,t),n="    if (obj."+t.name;return!t.repeated&&(!r||!r._proto.fields)&&((i===void 0||i)&&(n+=" != undefined"),i&&(n+=" && obj."+t.name+" !== "+JSON.stringify(i))),n+") "}function z(e){return e.options.packed==="true"}const oe=Y(k),yt=Fe({__proto__:null,default:oe},[k]);var R={exports:{}},bt=function(e){var t=function(a){var f=a.indexOf("//");return f>-1?a.slice(0,f):a},i=function(){var a=!1;return function(f){return f==="/*"?(a=!0,!1):f==="*/"?(a=!1,!1):!a}},r=function(a){return a.trim()},n=function(a){return function(f){var u="$"+a.length+"$";return a.push(f),u}},s=function(a){var f=/^\$(\d+)\$$/;return function(u){var c=u.match(f);return c?a[+c[1]]:u}},o=[];return e.replace(/"(\\"|[^"\n])*?"|'(\\'|[^'\n])*?'/gm,n(o)).replace(/([;,{}()=:[\]<>]|\/\*|\*\/)/g," $1 ").split(/\n/).map(r).filter(Boolean).map(t).map(r).filter(Boolean).join(`
`).split(/\s+|\n+/gm).filter(i()).map(s(o))},Ft=bt,Et=536870911,_t=["int32","int64","uint32","uint64","sint32","sint64","bool","fixed64","sfixed64","double","fixed32","sfixed32","float"],ae=function(e){var t=e.shift();if(t!=="{")return t;t={};for(var i="";e.length;)switch(e[0]){case"}":return e.shift(),t;case":":e.shift(),t[i]=ae(e);break;default:i=e.shift()}},fe=function(e){for(var t={};e.length;)switch(e[0]){case"[":case",":{e.shift();var i=e.shift();i==="("&&(i=e.shift(),e.shift());var r=[];if(e[0][0]==="."&&(r=e[0].substr(1).split("."),e.shift()),e[0]!=="=")throw new Error("Unexpected token in field options: "+e[0]);if(e.shift(),e[0]==="]")throw new Error("Unexpected ] in field option");var n=[i].concat(r),s=n.pop(),o=n.reduce(function(a,f,u){return a[f]==null&&(a[f]={}),a[f]},t);o[s]=ae(e);break}case"]":return e.shift(),t;default:throw new Error("Unexpected token in field options: "+e[0])}throw new Error("No closing tag for field options")},T=function(e){for(var t={name:null,type:null,tag:-1,map:null,oneof:null,required:!1,repeated:!1,options:{}};e.length;)switch(e[0]){case"=":e.shift(),t.tag=Number(e.shift());break;case"map":if(t.type="map",t.map={from:null,to:null},e.shift(),e[0]!=="<")throw new Error("Unexpected token in map type: "+e[0]);if(e.shift(),t.map.from=e.shift(),e[0]!==",")throw new Error("Unexpected token in map type: "+e[0]);if(e.shift(),t.map.to=e.shift(),e[0]!==">")throw new Error("Unexpected token in map type: "+e[0]);e.shift(),t.name=e.shift();break;case"repeated":case"required":case"optional":var i=e.shift();t.required=i==="required",t.repeated=i==="repeated",t.type=e.shift(),t.name=e.shift();break;case"[":t.options=fe(e);break;case";":if(t.name===null)throw new Error("Missing field name");if(t.type===null)throw new Error("Missing type in message field: "+t.name);if(t.tag===-1)throw new Error("Missing tag number in message field: "+t.name);return e.shift(),t;default:throw new Error("Unexpected token in message field: "+e[0])}throw new Error("No ; found for message field")},St=function(e){for(var t={enums:[],options:{},messages:[],fields:[],extends:[],extensions:null};e.length;)switch(e[0]){case"map":case"repeated":case"optional":case"required":t.fields.push(T(e));break;case"enum":t.enums.push(ce(e));break;case"message":t.messages.push(G(e));break;case"extensions":t.extensions=Dt(e);break;case"oneof":e.shift();var i=e.shift();if(e[0]!=="{")throw new Error("Unexpected token in oneof: "+e[0]);for(e.shift();e[0]!=="}";){e.unshift("optional");var r=T(e);r.oneof=i,t.fields.push(r)}e.shift();break;case"extend":t.extends.push(ue(e));break;case";":e.shift();break;case"reserved":for(e.shift();e[0]!==";";)e.shift();break;case"option":var n=D(e);if(t.options[n.name]!==void 0)throw new Error("Duplicate option "+n.name);t.options[n.name]=n.value;break;default:e.unshift("optional"),t.fields.push(T(e))}return t},ue=function(e){var t={name:e[1],message:G(e)};return t},Dt=function(e){e.shift();var t=Number(e.shift());if(isNaN(t))throw new Error("Invalid from in extensions definition");if(e.shift()!=="to")throw new Error("Expected keyword 'to' in extensions definition");var i=e.shift();if(i==="max"&&(i=Et),i=Number(i),isNaN(i))throw new Error("Invalid to in extensions definition");if(e.shift()!==";")throw new Error("Missing ; in extensions definition");return{from:t,to:i}},G=function(e){e.shift();var t=1,i=[],r={name:e.shift(),options:{},enums:[],extends:[],messages:[],fields:[]};if(e[0]!=="{")throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if(e[0]==="{"?t++:e[0]==="}"&&t--,!t)return e.shift(),i=St(i),r.enums=i.enums,r.messages=i.messages,r.fields=i.fields,r.extends=i.extends,r.extensions=i.extensions,r.options=i.options,r;i.push(e.shift())}if(t)throw new Error("No closing tag for message")},Vt=function(e){e.shift();var t=e.shift();if(e[0]!==";")throw new Error("Expected ; but found "+e[0]);return e.shift(),t},Mt=function(e){if(e.shift(),e[0]!=="=")throw new Error("Expected = but found "+e[0]);e.shift();var t=e.shift();switch(t){case'"proto2"':t=2;break;case'"proto3"':t=3;break;default:throw new Error("Expected protobuf syntax version but found "+t)}if(e[0]!==";")throw new Error("Expected ; but found "+e[0]);return e.shift(),t},jt=function(e){if(e.length<4)throw new Error("Invalid enum value: "+e.slice(0,3).join(" "));if(e[0]==="reserved"){for(e.shift();e[0]!==";";)e.shift();return e.shift(),null}if(e[1]!=="=")throw new Error("Expected = but found "+e[1]);if(e[3]!==";"&&e[3]!=="[")throw new Error("Expected ; or [ but found "+e[1]);var t=e.shift();e.shift();var i={value:null,options:{}};return i.value=Number(e.shift()),e[0]==="["&&(i.options=fe(e)),e.shift(),{name:t,val:i}},ce=function(e){e.shift();var t={},i={name:e.shift(),values:{},options:{}};if(e[0]!=="{")throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if(e[0]==="}")return e.shift(),e[0]===";"&&e.shift(),i;if(e[0]==="option"){t=D(e),i.options[t.name]=t.value;continue}var r=jt(e);r!==null&&(i.values[r.name]=r.val)}throw new Error("No closing tag for enum")},D=function(e){for(var t=null,i=null,r=function(s){return s==="true"?!0:s==="false"?!1:s.replace(/^"+|"+$/gm,"")};e.length;){if(e[0]===";")return e.shift(),{name:t,value:i};switch(e[0]){case"option":e.shift();var n=e[0]==="(";if(n&&e.shift(),t=e.shift(),n){if(e[0]!==")")throw new Error("Expected ) but found "+e[0]);e.shift()}e[0][0]==="."&&(t+=e.shift());break;case"=":if(e.shift(),t===null)throw new Error("Expected key for option with value: "+e[0]);if(i=r(e.shift()),t==="optimize_for"&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(i))throw new Error("Unexpected value for option optimize_for: "+i);i==="{"&&(i=C(e));break;default:throw new Error("Unexpected token in option: "+e[0])}}},C=function(e){for(var t=function(o){return o==="true"?!0:o==="false"?!1:o.replace(/^"+|"+$/gm,"")},i={};e.length;){if(e[0]==="}")return e.shift(),i;var r=e[0]==="(";r&&e.shift();var n=e.shift();if(r){if(e[0]!==")")throw new Error("Expected ) but found "+e[0]);e.shift()}var s=null;switch(e[0]){case":":if(i[n]!==void 0)throw new Error("Duplicate option map key "+n);e.shift(),s=t(e.shift()),s==="{"&&(s=C(e)),i[n]=s,e[0]===";"&&e.shift();break;case"{":if(e.shift(),s=C(e),i[n]===void 0&&(i[n]=[]),!Array.isArray(i[n]))throw new Error("Duplicate option map key "+n);i[n].push(s);break;default:throw new Error("Unexpected token in option map: "+e[0])}}throw new Error("No closing tag for option map")},Bt=function(e){e.shift();var t=e.shift().replace(/^"+|"+$/gm,"");if(e[0]!==";")throw new Error("Unexpected token: "+e[0]+'. Expected ";"');return e.shift(),t},Tt=function(e){e.shift();var t={name:e.shift(),methods:[],options:{}};if(e[0]!=="{")throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if(e[0]==="}")return e.shift(),e[0]===";"&&e.shift(),t;switch(e[0]){case"option":var i=D(e);if(t.options[i.name]!==void 0)throw new Error("Duplicate option "+i.name);t.options[i.name]=i.value;break;case"rpc":t.methods.push(Nt(e));break;default:throw new Error("Unexpected token in service: "+e[0])}}throw new Error("No closing tag for service")},Nt=function(e){e.shift();var t={name:e.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if(e[0]!=="(")throw new Error("Expected ( but found "+e[0]);if(e.shift(),e[0]==="stream"&&(e.shift(),t.client_streaming=!0),t.input_type=e.shift(),e[0]!==")")throw new Error("Expected ) but found "+e[0]);if(e.shift(),e[0]!=="returns")throw new Error("Expected returns but found "+e[0]);if(e.shift(),e[0]!=="(")throw new Error("Expected ( but found "+e[0]);if(e.shift(),e[0]==="stream"&&(e.shift(),t.server_streaming=!0),t.output_type=e.shift(),e[0]!==")")throw new Error("Expected ) but found "+e[0]);if(e.shift(),e[0]===";")return e.shift(),t;if(e[0]!=="{")throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if(e[0]==="}")return e.shift(),e[0]===";"&&e.shift(),t;if(e[0]==="option"){var i=D(e);if(t.options[i.name]!==void 0)throw new Error("Duplicate option "+i.name);t.options[i.name]=i.value}else throw new Error("Unexpected token in rpc options: "+e[0])}throw new Error("No closing tag for rpc")},Pt=function(e){for(var t=Ft(e.toString()),i=0;i<t.length;i++)if(/^("|')([^'"]*)$/.test(t[i])){var r;for(t[i].length===1?r=i+1:r=i,r;r<t.length;r++)if(/^[^'"\\]*(?:\\.[^'"\\]*)*("|')$/.test(t[r])){t=t.slice(0,i).concat(t.slice(i,r+1).join("")).concat(t.slice(r+1));break}}for(var n={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},s=!0;t.length;){switch(t[0]){case"package":n.package=Vt(t);break;case"syntax":if(!s)throw new Error("Protobuf syntax version should be first thing in file");n.syntax=Mt(t);break;case"message":n.messages.push(G(t));break;case"enum":n.enums.push(ce(t));break;case"option":var o=D(t);if(n.options[o.name])throw new Error("Duplicate option "+o.name);n.options[o.name]=o.value;break;case"import":n.imports.push(Bt(t));break;case"extend":n.extends.push(ue(t));break;case"service":n.services||(n.services=[]),n.services.push(Tt(t));break;default:throw new Error("Unexpected token: "+t[0])}s=!1}return n.extends.forEach(function(a){n.messages.forEach(function(f){f.name===a.name&&a.message.fields.forEach(function(u){if(!f.extensions||u.tag<f.extensions.from||u.tag>f.extensions.to)throw new Error(f.name+" does not declare "+u.tag+" as an extension number");f.fields.push(u)})})}),n.messages.forEach(function(a){a.fields.forEach(function(f){var u,c,d,l;function g(x){return x.name===f.type}function me(x){return x.name===d}if(f.options&&f.options.packed==="true"&&_t.indexOf(f.type)===-1){if(f.type.indexOf(".")===-1){if(a.enums&&a.enums.some(g))return}else{if(u=f.type.split("."),u.length>2)throw new Error("what is this?");if(c=u[0],d=u[1],n.messages.some(function(x){if(x.name===c)return l=x,x}),l&&l.enums&&l.enums.some(me))return}throw new Error("Fields of type "+f.type+' cannot be declared [packed=true]. Only repeated fields of primitive numeric types (types which use the varint, 32-bit, or 64-bit wire types) can be declared "packed". See https://developers.google.com/protocol-buffers/docs/encoding#optional')}})}),n},zt=Pt,Ct=function(e,t){return t.push('import "'+e+'";',""),t},H=function(e,t){var i=e.repeated?"repeated":e.required?"required":"optional";e.type==="map"&&(i="map<"+e.map.from+","+e.map.to+">"),e.oneof&&(i="");var r=Object.keys(e.options||{}).map(function(n){return n+" = "+e.options[n]}).join(",");return r&&(r=" ["+r+"]"),t.push((i?i+" ":"")+(e.map==="map"?"":e.type+" ")+e.name+" = "+e.tag+r+";"),t},he=function(e,t){t.push("message "+e.name+" {"),e.options||(e.options={}),V(e.options,t),e.enums||(e.enums=[]),e.enums.forEach(function(r){t.push(le(r,[]))}),e.messages||(e.messages=[]),e.messages.forEach(function(r){t.push(he(r,[]))});var i={};return e.fields||(e.fields=[]),e.fields.forEach(function(r){r.oneof?(i[r.oneof]||(i[r.oneof]=[]),i[r.oneof].push(H(r,[]))):t.push(H(r,[]))}),Object.keys(i).forEach(function(r){i[r].unshift("oneof "+r+" {"),i[r].push("}"),t.push(i[r])}),t.push("}",""),t},le=function(e,t){t.push("enum "+e.name+" {"),e.options||(e.options={});var i=V(e.options,[]);return i.length>1&&t.push(i.slice(0,-1)),Object.keys(e.values).map(function(r){var n=Ut(e.values[r]);t.push([r+" = "+n+";"])}),t.push("}",""),t},Ut=function(e,t){var i=Object.keys(e.options||{}).map(function(n){return n+" = "+e.options[n]}).join(",");i&&(i=" ["+i+"]");var r=e.value+i;return r},V=function(e,t){var i=Object.keys(e);return i.forEach(function(r){var n=e[r];~r.indexOf(".")&&(r="("+r+")");var s=typeof n;s==="object"?(n=U(n,[]),n.length&&t.push("option "+r+" = {",n,"};")):(s==="string"&&r!=="optimize_for"&&(n='"'+n+'"'),t.push("option "+r+" = "+n+";"))}),i.length>0&&t.push(""),t},U=function(e,t){var i=Object.keys(e);return i.forEach(function(r){var n=e[r],s=typeof n;s==="object"?Array.isArray(n)?n.forEach(function(o){o=U(o,[]),o.length&&t.push(r+" {",o,"}")}):(n=U(n,[]),n.length&&t.push(r+" {",n,"}")):(s==="string"&&(n='"'+n+'"'),t.push(r+": "+n))}),t},Ot=function(e,t){return t.push("service "+e.name+" {"),e.options||(e.options={}),V(e.options,t),e.methods||(e.methods=[]),e.methods.forEach(function(i){t.push(At(i,[]))}),t.push("}",""),t},At=function(e,t){var i="rpc "+e.name+"(";e.client_streaming&&(i+="stream "),i+=e.input_type+") returns (",e.server_streaming&&(i+="stream "),i+=e.output_type+")",e.options||(e.options={});var r=V(e.options,[]);return r.length>1?t.push(i+" {",r.slice(0,-1),"}"):t.push(i+";"),t},pe=function(e){return function(t){return Array.isArray(t)?t.map(pe(e+"  ")).join(`
`):e+t}},$t=function(e){var t=[];return t.push('syntax = "proto'+e.syntax+'";',""),e.package&&t.push("package "+e.package+";",""),e.imports&&e.imports.forEach(function(i){Ct(i,t)}),e.options||(e.options={}),V(e.options,t),e.enums||(e.enums=[]),e.enums.forEach(function(i){le(i,t)}),e.messages||(e.messages=[]),e.messages.forEach(function(i){he(i,t)}),e.services&&e.services.forEach(function(i){Ot(i,t)}),t.map(pe("")).join(`
`)},de=zt,It=$t;R.exports=de;var Lt=R.exports.parse=de;R.exports.stringify=It;const F=class F{constructor(t,i,r,n){p(this,"_size");p(this,"_x0");p(this,"_y0");this._size=t*Math.pow(2,n),this._x0=t*i,this._y0=t*r}static signedArea(t){let i=0;const r=t.length;let n=r-1,s,o;for(let a=0;a<r;a++)s=t[a],o=t[n],i+=(o.x-s.x)*(s.y+o.y),n=a;return i}static classifyRings(t){if(t.length<=0)throw"Now rings in polygon found";if(t.length==1)return[t];const i=[];let r;for(let n=0;n<t.length;n++){let s=t[n];const o=this.signedArea(s);if(o===0)continue;o<0===o<0?(r&&i.push(r),r=[s]):r.push(s)}return r&&i.push(r),i}toGeoJson(t,i,r){let n=this.encodeGeometry(t),s;switch(i){case 1:const f=[];for(let u=0;u<n.length;u++)f[u]=n[u][0];n=f,this.project(n);break;case 2:for(let u=0;u<n.length;u++)this.project(n[u]);break;case 3:s=F.classifyRings(n);for(let u=0;u<s.length;u++)for(let c=0;c<s[u].length;c++)this.project(s[u][c]);break}let o=F.geom_types[i],a;return n.length===1?a=(s??n)[0]:(a=s??n,o="Multi"+o),{type:"Feature",geometry:{type:o,coordinates:a},properties:r}}encodeGeometry(t){let i=0,r=0,n=[],s=[];for(let o=0;o<t.length;o++){let a=t[o],f=a&7,u=a>>3;if(f===1&&s.length!==0&&(n.push(s),s=[]),f===1||f===2){for(let c=0;c<u;c++){const d=t[o+c*2+1];i+=d>>1^-(d&1);const l=t[o+c*2+2];r+=l>>1^-(l&1),s.push([i,r])}o+=u*2}f===7&&(s.push([...s[0]]),o++)}return s.length>0&&n.push(s),n}project(t){const i=this._y0,r=this._x0,n=this._size;for(let s=0;s<t.length;s++){let o=t[s],a=180-(o[1]+i)*360/n;t[s]=[(o[0]+r)*360/n-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}return t}};p(F,"geom_types",["Unknown","Point","LineString","Polygon"]);let O=F;const b=class b{constructor(t,i,r,n,s,o){p(this,"features");p(this,"_url");p(this,"_layerName");p(this,"_features",new ve([]));p(this,"x");p(this,"y");p(this,"z");this._url=t,this._layerName=s,this.x=i,this.y=r,this.z=n,this.downloadSync(),this.features=this._features.map(a=>a===void 0||(o==null?void 0:o.data)===!1?[]:a,[o])}getValue(t){if(t.string_value!=="")return t.string_value;if(t.double_value!==0)return t.double_value;if(t.float_value!==0)return t.float_value;if(t.int_value!==0)return t.int_value;if(t.uint_value!==0)return t.uint_value;if(t.sint_value!==0)return t.sint_value;if(t.bool_value!==!1)return t.bool_value}downloadSync(){this.download().then(t=>{if(t.length!==0)return this._features.setData(t)}).catch(t=>{console.error(t)})}async download(){const t=await fetch(this._url);if(t.status!==200)return console.error("Could not download tile "+this._url),[];const i=await t.arrayBuffer(),r=b.tile_schema.read(new Le(i)),n=r.layers;let s=r.layers[0];if(n.length>1){if(!this._layerName)throw"Multiple layers in the downloaded tile, but no layername is given to choose from";s=n.find(f=>f.name===this._layerName)}if(!s)return[];const o=new O(s.extent,this.x,this.y,this.z),a=[];for(const f of s.features){const u=this.inflateProperties(f.tags,s.keys,s.values);a.push(o.toGeoJson(f.geometry,f.type,u))}return a}inflateProperties(t,i,r){const n={};for(let o=0;o<t.length;o+=2)n[i[t[o]]]=this.getValue(r[t[o+1]]);let s;switch(n.osm_type){case"N":s="node";break;case"W":s="way";break;case"R":s="relation";break}return n.id=s+"/"+n.osm_id,delete n.osm_id,delete n.osm_type,n}};p(b,"schemaSpec21",`
    package vector_tile;

option optimize_for = LITE_RUNTIME;

message Tile {

        // GeomType is described in section 4.3.4 of the specification
        enum GeomType {
             UNKNOWN = 0;
             POINT = 1;
             LINESTRING = 2;
             POLYGON = 3;
        }

        // Variant type encoding
        // The use of values is described in section 4.1 of the specification
        message Value {
                // Exactly one of these values must be present in a valid message
                optional string string_value = 1;
                optional float float_value = 2;
                optional double double_value = 3;
                optional int64 int_value = 4;
                optional uint64 uint_value = 5;
                optional sint64 sint_value = 6;
                optional bool bool_value = 7;

                extensions 8 to max;
        }

        // Features are described in section 4.2 of the specification
        message Feature {
                optional uint64 id = 1 [ default = 0 ];

                // Tags of this feature are encoded as repeated pairs of
                // integers.
                // A detailed description of tags is located in sections
                // 4.2 and 4.4 of the specification
                repeated uint32 tags = 2 [ packed = true ];

                // The type of geometry stored in this feature.
                optional GeomType type = 3 [ default = UNKNOWN ];

                // Contains a stream of commands and parameters (vertices).
                // A detailed description on geometry encoding is located in
                // section 4.3 of the specification.
                repeated uint32 geometry = 4 [ packed = true ];
        }

        // Layers are described in section 4.1 of the specification
        message Layer {
                // Any compliant implementation must first read the version
                // number encoded in this message and choose the correct
                // implementation for this version number before proceeding to
                // decode other parts of this message.
                required uint32 version = 15 [ default = 1 ];

                required string name = 1;

                // The actual features in this tile.
                repeated Feature features = 2;

                // Dictionary encoding for keys
                repeated string keys = 3;

                // Dictionary encoding for values
                repeated Value values = 4;

                // Although this is an "optional" field it is required by the specification.
                // See https://github.com/mapbox/vector-tile-spec/issues/47
                optional uint32 extent = 5 [ default = 4096 ];

                extensions 16 to max;
        }

        repeated Layer layers = 3;

        extensions 16 to 8191;
}
`),p(b,"tile_schema",(oe??yt)(Lt(b.schemaSpec21)).Tile);let E=b;class Rt extends ${constructor(i,r,n,s,o){super(i,r,n,s,o);p(this,"_zoomlevel");this._zoomlevel=i}addDataFromSources(i){var a;i=_.NoNull(i);const r=new Map,n=((a=this._zoomlevel)==null?void 0:a.data)??0;for(const f of i){if(f.z!=n)continue;const u=w.tile_bounds_lon_lat(f.z,f.x,f.y);new be(u).asGeoJson({});for(const c of f.features.data){const d=c.properties.id,l=[];if(c.geometry.type==="LineString")l.push(c.geometry.coordinates);else if(c.geometry.type==="MultiLineString")l.push(...c.geometry.coordinates);else{console.error("Invalid geometry type:",c.geometry.type);continue}const g=r.get(d);if(!g){r.set(d,{type:"Feature",properties:c.properties,geometry:{type:"MultiLineString",coordinates:l}});continue}g.geometry.coordinates.push(...l)}}const s=Array.from(r.keys());for(const f of s)r.set(f,Z.attemptLinearize(r.get(f)));const o=Array.from(r.values());this.features.setData(o),this._featuresById.setData(r)}}class Gt extends ${constructor(t,i,r,n,s){super(t,i,r,n,s)}addDataFromSources(t){t=_.NoNull(t);const i=new Map,r=new Map;for(const s of t){let o=s.z;for(const a of s.features.data){const f=a.properties.id;if(f.endsWith("146616907")&&console.log("Horeca totaal"),!i.has(f)){i.set(f,a),r.set(f,o);continue}const u=i.get(f),c=r.get(f);if(c>o)continue;if(c<o){i.set(f,a),r.set(f,o);continue}const d=Z.union(a,u);d.properties=u.properties,i.set(f,d),r.set(f,o)}}const n=Array.from(i.values());this.features.setData(n),this._featuresById.setData(i)}}class Wt extends Gt{constructor(t,i,r){const n=i.zoom.mapD(s=>Math.min(Math.floor(s/2)*2,14));super(n,t.minzoom,s=>{const[o,a,f]=w.tile_from_index(s),u=_.SubstituteKeys(A.VectorTileServer,{z:o,x:a,y:f,layer:t.id,type:"polygons"});return new E(u,a,f,o)},i,{isActive:r==null?void 0:r.isActive})}}class Jt extends Rt{constructor(t,i,r){const n=i.zoom.mapD(s=>Math.min(Math.floor(s/2)*2,14));super(n,t.minzoom,s=>{const[o,a,f]=w.tile_from_index(s),u=_.SubstituteKeys(A.VectorTileServer,{z:o,x:a,y:f,layer:t.id,type:"lines"});return new E(u,a,f,o)},i,{isActive:r==null?void 0:r.isActive})}}class Kt extends ${constructor(t,i,r){const n=i.zoom.mapD(s=>Math.min(Math.floor(s/2)*2,14));super(n,t.minzoom,s=>{const[o,a,f]=w.tile_from_index(s),u=_.SubstituteKeys(A.VectorTileServer,{z:o,x:a,y:f,layer:t.id,type:"pois"});return new E(u,a,f,o)},i,{isActive:r==null?void 0:r.isActive})}}class kt extends X{constructor(t,i,r){super(new Kt(t,i,r),new Jt(t,i,r),new Wt(t,i,r))}}export{$ as D,kt as a};
//# sourceMappingURL=DynamicMvtTileSource-ec0ec15c.js.map
